<!DOCTYPE html>
<html>
<head>
    <title>Questionnaire Game</title>
    <style>
        .container {
            display: flex;
            justify-content: space-around;
            align-items: center;
        }
        .photo {
            width: 150px;
            height: 150px;
            background-size: cover;
            border-radius: 50%;
        }
        .message-box {
            width: 300px;
            height: 400px;
            border: 1px solid #ccc;
            overflow-y: scroll;
            padding: 10px;
        }
        .question {
            margin-bottom: 10px;
        }
        .options {
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="photo" style="background-image: url('player-photo.jpg');"></div>
        <div class="message-box" id="messageBox"></div>
        <div class="photo" style="background-image: url('npc-photo.jpg');"></div>
    </div>
    <button onclick="calculateResult()">完成</button>

    <script src="../record/score.js"></script>
    <script>
        // Load questions from questions.json
        fetch('questions.json')
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                return response.json();
            })
            .then(data => {
                if (data.questions && Array.isArray(data.questions)) {
                    displayQuestions(data.questions);
                } else {
                    console.error('Loaded data is not an array or missing "questions" key:', data);
                }
            })
            .catch(error => {
                console.error('There was a problem with your fetch operation:', error);
            });
    
        function displayQuestions(questions) {
            const messageBox = document.getElementById('messageBox');
            questions.forEach(question => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'question';
                questionDiv.innerHTML = `
                    <div>題號：${question.id}</div>
                    <div>${question.description}</div>
                    <div class="options">
                        ${question.options.map((option, i) => `<input type="radio" name="question${question.id}" value="${i}">${option}<br>`).join('')}
                    </div>
                `;
                messageBox.appendChild(questionDiv);
            });
        }

        function calculateResult() {
            const scores = [0, 0, 0, 0]; // Scores for each career type
            const questions = document.querySelectorAll('.question');
            questions.forEach(question => {
                const selectedOption = question.querySelector('input[type="radio"]:checked');
                if (selectedOption) {
                    scores[selectedOption.value]++;
                }
            });

            // Determine the highest score
            const maxScore = Math.max(...scores);
            const careerTypes = ['創新型或領導型職業', '分析型或專業型職業', '支持型或行政型職業', '互動型或團隊型職業'];
            const suitableCareer = careerTypes[scores.indexOf(maxScore)];
            gameScores.level2 = suitableCareer;
            alert(`最適合的工作類型：${suitableCareer}`);
            window.location.href = '../index.html';
        }
    </script>
</body>
</html>
